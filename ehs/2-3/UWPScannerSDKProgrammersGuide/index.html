

        <hr>

<p>title: UWP Scanner SDK for Windows
layout: guide.html
product: UWP Scanner SDK Programmers Guide</p>

<h2 id="productversion1000" class="anchor"><a class="heading-anchor" href="#productversion1000"><span></span></a>productversion: '1.0.0.0'</h2>

<p><!-- </p>

<h2 id="introduction">Introduction</h2>

<p>The UWP Scanner SDK provides an API for Windows UWP applications to communicate/manage Zebra barcode scanners. Host connected Zebra barcode scanners can be discovered via the UWP Scanner SDK. The SDK allows capture of barcode decode events and configuration of connected Zebra barcode scanners (enabling and disabling specific barcode symbologies). </p>

<hr />

<h2 id="gettingstartedwiththeuwpscannersdkforwindows">Getting Started with the UWP Scanner SDK for Windows</h2>

<h3 id="overview">Overview</h3>

<p>This document provides step-by-step instructions to create Windows UWP applications that work with Zebra barcode scanners. The Scanner SDK allows building Microsoft UWP Zebra barcode scanner enabled applications for Window 10 with Visual Studio 2017. The SDK provides the ability to manage Zebra barcode scanners, perform various operations with connected barcode scanners, configure connected scanners and retrieve other information related to scanners connected over USB. All available APIs are defined under the <code>Zebra.BarcodeScanner.SDK</code> and <code>NGScannerSDK.APIContracts</code> namespaces. The application uses a <code>DataCaptureDeviceAdapter</code> object to interact with a scanner. Use a <code>DataCaptureDeviceAdapter</code> object instance to connect with a scanner and receive barcode decode events.</p>

<h3 id="creatingawindowsproject">Creating a Windows Project</h3>

<p>To create a C# Windows project in Visual Studio 2017:</p>

<p>Start Visual Studio 2017->Select File-> New-> Project->Visual C#, create a new Blank App (Universal Windows) project and follow the on screen steps in Visual Studio.</p>

<p><img src="../Images/CreateUWPProject.png" alt="Figure 1-1  Create New Project" /></p>

<p>Add a reference to <code>ZebraBarcodeScanner.SDK.DataCaptureDevice</code>, <code>Zebra.BarcodeScanner.SDK.DeviceManager</code> and <code>NGScannerSDK.APIContracts</code> assemblies/DLLs from Windows UWP Scanner SDK binaries.</p>

<p>Import the <code>Zebra.BarcodeScanner.SDK</code> / <code>NGScannerSDK.APIContracts</code> namespaces.</p>

<h3 id="buildingandrunningaproject">Building and Running a Project</h3>

<p>Before building/running make sure the Windows UWP Scanner SDK assemblies are in the target application folder. </p>

<p>Add the following settings to the <strong><em>Package.appxmanifest</em></strong> xml file (right click the <strong><em>Package.appxmanifest</em></strong>  file in Visual Studio Solution Explorer and click the �view code� context menu to edit this file):</p>

<pre><code>:::xml
  &lt;Capabilities&gt;
    &lt;Capability Name="internetClient" /&gt;
    &lt;DeviceCapability Name="humaninterfacedevice"&gt;
      Scanner Device
      &lt;Device Id="vidpid:05E0 1300"&gt;
        &lt;Function Type="usage:FF45 4B00" /&gt;
      &lt;/Device&gt;
      &lt;Device Id="vidpid:05E0 1900"&gt;
        &lt;Function Type="usage:FF11 0E00" /&gt;
      &lt;/Device&gt;
      &lt;Device Id="vidpid:05E0 1400"&gt;
        &lt;Function Type="usage:FF45 4A00" /&gt;
      &lt;/Device&gt;
    &lt;/DeviceCapability&gt;
  &lt;/Capabilities&gt;
</code></pre>

<h3 id="sampleapplicationtodiscoverscannersandreceivedecodedatanotifications">Sample Application to Discover Scanners and Receive Decode Data Notifications</h3>

<p>Following is a code snippet to discover barcode scanners and receive decode events using the UWP Scanner SDK.</p>

<pre><code>:::CSharp
    using System;
    using System.Text;
    using System.Collections.Generic;
    using Windows.UI.Xaml;
    using Windows.UI.Xaml.Controls;

    // UWP Scanner SDK API namespaces
    using NGScannerSDK.APIContracts;
    using Zebra.BarcodeScanner.SDK.DataCaptureDevice;
    using Zebra.BarcodeScanner.SDK.DeviceManager;
    using System.Diagnostics;

    namespace TestApp
    {
        public sealed partial class MainPage : Page
        {
            // Main device collection manager class
            private DeviceManager deviceManager = null;
            // List of discovered devices
            private List&lt;IDeviceEndpointInfo&gt; deviceList = new List&lt;IDeviceEndpointInfo&gt;();

            public MainPage()
            {
                this.InitializeComponent();
                InitializeScannerSDK();
            }

            private void  InitializeScannerSDK()
            {
                deviceManager = DeviceManager.Create(); 
                deviceManager.DeviceAdded += DeviceManager_DeviceAttached;
                deviceManager.DeviceRemoved += DeviceManager_DeviceDetached;

                // Discover barcode scanners
                deviceManager.DiscoverDevices();
           }

            // Event triggered when scanner connected to host
            private async void DeviceManager_DeviceAttached(object sender, IDeviceEndpointInfo e)
            {
                // Add discovered device to scanner list
                deviceList.Add(e);
            }

            // Event triggered when scanner disconnected from host
            private void DeviceManager_DeviceDetached(object sender, IDeviceEndpointInfo e)
            {
            }

            // Connect to discovered device (device 0), and register for barcode events
            private async void btnConnect_Click(object sender, RoutedEventArgs e)
            {
                DataCaptureDeviceAdapter dataCaptureDevice = null;
                try
                {
                    dataCaptureDevice =DataCaptureDeviceAdapter.Create(deviceList[0]);
                }
                catch (Exception exception)
                {
                    Debug.WriteLine(exception);
                    throw;
                }

                if (dataCaptureDevice != null)
                {
                 // Connect to scanner
                    await dataCaptureDevice.ConnectAsync();
                    Debug.WriteLine("Connected successfully to barcode scanner");

                    // Register for barcode event notification
                    dataCaptureDevice.OnDecodeDataEvent += DataCaptureDevice_OnDecodeDataEvent;
                }
            }
            // Event triggered on barcode decode
            private async void DataCaptureDevice_OnDecodeDataEvent(object sender, DecodeDataEventArgs e)
            {
                Debug.WriteLine("Decode Data = "+Encoding.UTF8.GetString(e.DecodeData, 0, e.DecodeData.Length));
                Debug.WriteLine("Symbology = "+e.Symbology.ToString());
            }
        }
    }
</code></pre>

<p>Call <code>DeviceManager.Create()</code> to create an instance of <code>DeviceManager</code> object.
Register for scanner attach/detach events as follows (specifying the callback event handler function):</p>

<pre><code>:::CSharp
    deviceManager.DeviceAdded += DeviceManager_DeviceAttached;
    deviceManager.DeviceRemoved += DeviceManager_DeviceDetached;
</code></pre>

<p>Call <code>deviceManager.DiscoverDevices()</code> to discover Zebra barcode scanners.
To connect to a discovered barcode scanner, create a <code>DataCaptureDeviceAdapter</code>  object by calling the <code>DataCaptureDeviceAdapter.Create</code>  method with the corresponding scanner <code>IDeviceEndpointInfo</code> type returned from the scanner attach event. Then call the async method <code>dataCaptureDevice.ConnectAsync()</code> to connect to the scanner. </p>

<pre><code>:::CSharp
    dataCaptureDevice = DataCaptureDeviceAdapter.Create(deviceList[0]);
    await dataCaptureDevice.ConnectAsync();
</code></pre>

<p>To register for barcode events (specifying the callback event handler function as follows):</p>

<pre><code>:::CSharp
    // Register for barcode event notification
    dataCaptureDevice.OnDecodeDataEvent += DataCaptureDevice_OnDecodeDataEvent;

    // Event triggered on barcode decode
    private async void DataCaptureDevice_OnDecodeDataEvent(object sender, DecodeDataEventArgs e)
    {
        Debug.WriteLine("Decode Data = "+Encoding.UTF8.GetString(e.DecodeData, 0, e.DecodeData.Length));
        Debug.WriteLine("Symbology = "+e.Symbology.ToString());
    }
</code></pre>

<p>The returned <code>DecodeDataEventArgs</code> object contains the decode data and the symbology of the scanned barcode.</p>


--></p>